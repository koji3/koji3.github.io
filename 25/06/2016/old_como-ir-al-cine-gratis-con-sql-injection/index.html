<!DOCTYPE html>
<html lang="en">
<head>
  <meta charset="utf-8">
  
  <title>Como ir al cine gratis con SQL injection | Jose-Linares.com</title>
  <meta name="viewport" content="width=device-width, initial-scale=1, maximum-scale=1">
  <meta name="description" content="El otro día estuve en el cine viendo Buscando a Dory, una película totalmente recomendable si te gustó Buscando a Nemo. El caso es que compramos las entradas por internet (5.90€ cada entrada). El bend">
<meta property="og:type" content="article">
<meta property="og:title" content="Como ir al cine gratis con SQL injection">
<meta property="og:url" content="http://jose-linares.com/25/06/2016/old_como-ir-al-cine-gratis-con-sql-injection/index.html">
<meta property="og:site_name" content="Jose-Linares.com">
<meta property="og:description" content="El otro día estuve en el cine viendo Buscando a Dory, una película totalmente recomendable si te gustó Buscando a Nemo. El caso es que compramos las entradas por internet (5.90€ cada entrada). El bend">
<meta property="og:image" content="http://jose-linares.com/wp-content/uploads/2016/06/Captura-de-pantalla-de-2016-06-25-16-40-48.png">
<meta property="og:image" content="http://jose-linares.com/wp-content/uploads/2016/06/Captura-de-pantalla-de-2016-06-25-16-54-35.png">
<meta property="og:image" content="http://jose-linares.com/wp-content/uploads/2016/06/Captura-de-pantalla-de-2016-06-25-17-02-38.png">
<meta property="og:image" content="http://jose-linares.com/wp-content/uploads/2016/06/Captura-de-pantalla-de-2016-06-25-17-05-03.png">
<meta property="og:image" content="http://jose-linares.com/wp-content/uploads/2016/06/Captura-de-pantalla-de-2016-06-25-17-10-58.png">
<meta property="og:updated_time" content="2017-01-04T22:12:12.364Z">
<meta name="twitter:card" content="summary">
<meta name="twitter:title" content="Como ir al cine gratis con SQL injection">
<meta name="twitter:description" content="El otro día estuve en el cine viendo Buscando a Dory, una película totalmente recomendable si te gustó Buscando a Nemo. El caso es que compramos las entradas por internet (5.90€ cada entrada). El bend">
<meta name="twitter:image" content="http://jose-linares.com/wp-content/uploads/2016/06/Captura-de-pantalla-de-2016-06-25-16-40-48.png">
  
    <link rel="alternate" href="/atom.xml" title="Jose-Linares.com" type="application/atom+xml">
  
  
    <link rel="icon" href="/favicon.ico">
  
  <link rel="stylesheet" href="/css/typing.css">
</head>

  
    <body>
  
      <div id="container" class="container">
        <article id="post-old_como-ir-al-cine-gratis-con-sql-injection" class="article article-type-post" itemscope itemprop="blogPost">
  <header id="header" class="header">
  <nav id="main-nav" class="main-nav">
    
      <a class="main-nav-link" href="/">Home</a>
    
      <a class="main-nav-link" href="/archives">Archives</a>
    
      <a class="main-nav-link" href="/about">About</a>
    
  </nav>
  <nav id="sub-nav">
    
      <a id="nav-rss-link" class="nav-icon" href="/atom.xml" title="RSS Feed"></a>
    
  </nav>
</header>

  <hr/>
  <div class="article-inner">
    
    
      <header class="article-header">
        
  
    <h1 class="article-title" itemprop="name">
      Como ir al cine gratis con SQL injection
    </h1>
  

      </header>
    
    <div class="article-entry typo" itemprop="articleBody">
      
        <p>El otro día estuve en el cine viendo Buscando a Dory, una película totalmente recomendable si te gustó Buscando a Nemo. El caso es que compramos las entradas por internet (5.90€ cada entrada). El bendito desarrollo tecnológico que nos permite reservar un asiento desde la comodidad de nuestro hogar. Un par de clicks, introduces tu información de pago y te mandan a tu correo un link con tu entrada. Este link es una url así: <a href="http://compraentradas.com/EntradaMail/373[...]6133" target="_blank" rel="external">http://compraentradas.com/EntradaMail/373[...]6133</a> y contiene un código de barras que posteriormente se escanea en el propio cine y se imprimen tus entradas: <img src="/wp-content/uploads/2016/06/Captura-de-pantalla-de-2016-06-25-16-40-48.png" alt="Captura de pantalla de 2016-06-25 16-40-48"> Pero… no hay ningún método de autenticación del usuario, por lo que cualquiera puede acceder a esa entrada si tiene el link. Investigando un poco veo que los ids de las entradas van aumentando pero no son consecutivas. Se podría probar con un ataque de fuerza bruta probando números hasta dar con una pelicula que nos convenza, en un cine cercano y en un horario que nos venga bien, imprimirla e ir al cine antes que su legítimo dueño. Una vez dentro procura sentarte en otro asiento por si van a buscarte. Pero como ya he dicho, estamos en el siglo XXI y la tecnología nos lo pone más fácil todavía. En compraentradas.com tienen un sistema que te permite recuperar tus entradas si las has perdido( <a href="http://www.compraentradas.com/CompruebaCompra" target="_blank" rel="external">http://www.compraentradas.com/CompruebaCompra</a> ). Para ello te pide el cine y la fecha de compra como datos obligatorios y tu email, el código de entrada o el número del código de barras:   [caption id=”attachment_1052” align=”aligncenter” width=”917”]<img src="http://jose-linares.com/wp-content/uploads/2016/06/Captura-de-pantalla-de-2016-06-25-16-54-35.png" alt=""> He perdido la entrada pero me sé el código de barras o la referencia. Si.[/caption] Esto te devuelve la entrada (o entradas (?) ) que coinciden con los criterios de búsqueda. Y si sabes como funciona puedes verlo como una máquina de entradas gratis.El caso es que esto huele a SQL injection desde aquí. Y no del difícil, basta con utilizar la palabra mágica ‘ or ‘1’=’1  en el campo de código de barras o referencia. Por lo visto a alguien no le pareció importante filtrar esa entrada de datos. Ahora seleccionamos el cine al que queremos ir, como fecha de compra hoy, o hace pocos días y como código de barras todos los que hagan cumplir que 1=1: <img src="http://jose-linares.com/wp-content/uploads/2016/06/Captura-de-pantalla-de-2016-06-25-17-02-38.png" alt="Captura de pantalla de 2016-06-25 17-02-38"> Esa búsqueda, por ejemplo, devuelve 287 resultados. 287 entradas entre las que elegir. Las que tienen la etiqueta “CORRECTA” enlazan al código de barras listo para imprimir: <img src="http://jose-linares.com/wp-content/uploads/2016/06/Captura-de-pantalla-de-2016-06-25-17-05-03.png" alt="Captura de pantalla de 2016-06-25 17-05-03"> Me quedo con Star Wars. <img src="http://jose-linares.com/wp-content/uploads/2016/06/Captura-de-pantalla-de-2016-06-25-17-10-58.png" alt="Captura de pantalla de 2016-06-25 17-10-58">   PD: Los de compraentradas están ya informados. Daos prisa o lo arreglarán :D EDIT: Este método ya no funciona, pero viendo la calidad de la plataforma probablemente encontréis más formas de atacar este sistema.</p>
<h2 id="Comments"><a href="#Comments" class="headerlink" title="Comments"></a>Comments</h2><p><strong><a href="#466" title="2016-08-23 14:43:25">platanito</a>:</strong> publica cosas cerdo joputa</p>
<p><strong><a href="#467" title="2016-08-23 14:48:15">Jose Linares Rojas</a>:</strong> Lo dice el que tiene un usuario hecho para publicar lo que quiera y aún no tiene ni una triste entrada xD</p>

      
    </div>
    <footer class="article-footer">
      <ul class="article-meta">
        <li>
          <span class="label">Published Date:</span>
          <a href="/25/06/2016/old_como-ir-al-cine-gratis-con-sql-injection/" class="article-date">
  <time datetime="2016-06-25T13:26:53.000Z" itemprop="datePublished">25/06/2016</time>
</a>

        </li>
        
        
        <hr/>
      </ul>
    </footer>
  </div>
  
    
<nav id="article-nav" class="article-nav">
  
    <a href="/30/11/2016/old_usando-la-magia-del-xss-en-latostadora-para-ataques-imaginativos/" id="article-nav-newer" class="article-nav-link-wrap newer">
      <strong class="article-nav-caption">Newer</strong>
      <div class="article-nav-title">
        
          Usando la magia del XSS en LaTostadora para ataques imaginativos
        
      </div>
    </a>
  
  
    <a href="/17/04/2016/old_hacer-funcionar-chrome-remote-desktop-en-fedora/" id="article-nav-older" class="article-nav-link-wrap older">
      <strong class="article-nav-caption">Older</strong>
      <div class="article-nav-title">Hacer funcionar Chrome-Remote-Desktop en Fedora</div>
    </a>
  
</nav>


  
</article>




      </div>
      
    <footer id="footer" class="post-footer footer">
      <hr/>
      <div id="footerContent" class="footer-content">
        <p>2017 @ Any Rights Reserved</p>


      </div>
    </footer>

      

<script src="//cdn.bootcss.com/jquery/2.2.4/jquery.min.js"></script>


  <link rel="stylesheet" href="/fancybox/jquery.fancybox.css">
  <script src="/fancybox/jquery.fancybox.pack.js"></script>


<script src="/js/typing.js"></script>
<!--[if lt IE 9]><script src="//cdnjs.cloudflare.com/ajax/libs/html5shiv/3.7/html5shiv.min.js"></script><![endif]-->







    </div>
  </body>
</html>
